---
title: "Transformadas de Fourier"
author: "Amanda Yumi"
date: "01 de outubro de 2018"
output: html_document
weight: 50
---



<p>O conteúdo dessa aula auxilia no entendimento da amostragem no domínio da frequência e reconstrução de sinais de tempo discreto. No quesito de análise de dados com EEG, os processos de transformação de amostras do domínio do tempo para o domínio da frequência. Estas incluem tanto a análise direta do espectro de frquência, bem como convoluções. Existem variações relacionadas com a transformada, dependendo do tipo de cada função.</p>
<p>A análise espectral decompõe o sinal de EEG em suas componentes fundamentais (harmônicos) que geram frequências conhecidas que podem ser distinguidas entre si.</p>
<pre class="r"><code>T = 100
lambda1 = 30
lambda2 = 50
lambda3 = 110

x= sin(2*pi*lambda1*(1:T)/T) +0.5*sin(2*pi*lambda2*(1:T)/T)
+0.25*sin(2*pi*lambda3*(1:T)/T)</code></pre>
<pre><code>##   [1]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -5.514005e-16
##   [6] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  1.102801e-15
##  [11]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01  1.221552e-16
##  [16] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  2.205602e-15
##  [21]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -9.806459e-16
##  [26] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01 -2.443104e-16
##  [31]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01  1.469267e-15
##  [36] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  4.411204e-15
##  [41]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -3.186248e-15
##  [46] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  1.961292e-15
##  [51]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -7.363355e-16
##  [56] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01 -4.886208e-16
##  [61]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01  1.713577e-15
##  [66] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01 -2.938533e-15
##  [71]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -1.004737e-14
##  [76] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  8.822409e-15
##  [81]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -7.597453e-15
##  [86] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  6.372496e-15
##  [91]  1.469463e-01  2.377641e-01  2.377641e-01  1.469463e-01 -5.147540e-15
##  [96] -1.469463e-01 -2.377641e-01 -2.377641e-01 -1.469463e-01  3.922584e-15</code></pre>
<pre class="r"><code>ts.plot(x)</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Ruído-branco Gaussiano. FFT: Fast Fourier Transform Idêntico à definição se T for potência de 2 (ou aproximação de).</p>
<pre class="r"><code>hist(rnorm(T))</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>x = x+rnorm(T)
ts.plot(x)</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<p>O R já calcula o estimador do espectro (periodograma). O conceito é definido como “estimado” pois ele faz uma estimativa e não uma média de todos os dados gerados. (MELHORAR EXPLICAÇÃO)</p>
<p>(COLOCAR AS FAIXAS DE FREQUÊNCIA DAS BANDAS delta &lt;4hz, theta 4-7hz, alfa 8-12hz, beta 13-30hz, gama &gt; 30hz… )</p>
<pre class="r"><code>ESPECTRO = spectrum(x)</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># O eixo x ficaria em 

plot(ESPECTRO$freq, ESPECTRO$spec, type = &quot;l&quot;)</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<div id="implementando-com-o-banco-de-dados" class="section level2">
<h2>Implementando com o banco de dados</h2>
<p>Realizando a leitura dos dados:</p>
<pre class="r"><code>#leitura dos sinais
sinais=read.table(&quot;OlhosFechados.txt&quot;,header=FALSE)

#leitura do nome dos canais
nomescanais=scan(&quot;NOMEScanais.txt&quot;,what=&quot;string&quot;)

dim(sinais)</code></pre>
<pre><code>## [1] 45315    32</code></pre>
<pre class="r"><code>nomescanais </code></pre>
<pre><code>##  [1] &quot;Fp1&quot;  &quot;Fp2&quot;  &quot;F7&quot;   &quot;F3&quot;   &quot;Fz&quot;   &quot;F4&quot;   &quot;F8&quot;   &quot;FC5&quot;  &quot;FC1&quot;  &quot;FC2&quot; 
## [11] &quot;FC6&quot;  &quot;T7&quot;   &quot;C3&quot;   &quot;Cz&quot;   &quot;C4&quot;   &quot;T8&quot;   &quot;TP9&quot;  &quot;CP5&quot;  &quot;CP1&quot;  &quot;CP2&quot; 
## [21] &quot;CP6&quot;  &quot;TP10&quot; &quot;P7&quot;   &quot;P3&quot;   &quot;Pz&quot;   &quot;P4&quot;   &quot;P8&quot;   &quot;PO9&quot;  &quot;O1&quot;   &quot;Oz&quot;  
## [31] &quot;O2&quot;   &quot;PO10&quot;</code></pre>
<p>Parametrizando as variáveis iniciais:</p>
<pre class="r"><code>#Taxa de amostragem
HZ=250

#Tamanho da epoca (janela) em segundos
TAMsegundos=5

#Tamanho da epoca (janela) em caselas do vetor de sinais
TAM=TAMsegundos*HZ

#Numero de epocas
Nepocas=floor(nrow(sinais)/TAM)

#Numero de canais
Ncanais=ncol(sinais)</code></pre>
<p>Criando matriz Espectro para armazenar a média dos periodogramas entre todas as épocas para cada canal. As linhas representam diferentes frequências As colunas representam os canais</p>
<pre class="r"><code>ESPECTRO=matrix(0,TAM/2,Ncanais)

#Calcular para cada canal
# Escondi a saída de todos os espectros porque tem muitos canais e épocas na saída
for(canal in 1:Ncanais){  
  y=0
  #Calcula a media entre épocas
  for(epoca in 1:Nepocas){
    #Descobrir caselas de inicio e fim de cada epoca
    INICIO=TAM*(epoca-1)+1
    FIM=epoca*TAM
    y=y+spectrum(sinais[INICIO:FIM,canal], plot = FALSE)$spec
  }#for da epoca
   ESPECTRO[,canal]=y/Nepocas
}#for do canal</code></pre>
</div>
<div id="grafico-do-espectro-no-canal-o1-coluna-29." class="section level1">
<h1>Grafico do espectro no canal O1, coluna 29.</h1>
<pre class="r"><code>plot((HZ/2)*(1:nrow(ESPECTRO))/nrow(ESPECTRO), ESPECTRO[, 29],
 type=&quot;l&quot;, xlab=&quot;Frequencia (Hz)&quot;, ylab=&quot;Potencia (uV^2)&quot;)</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Ajustando o zoom para conseguir visualizar a informação melhor:</p>
<pre class="r"><code># O professor colocou 10:200 mas voce nao quer ver 190 gráficos aqui
IX=10:200
plot((HZ/2)*IX/nrow(ESPECTRO), ESPECTRO[IX,29],
 type=&quot;l&quot;,xlab=&quot;Frequencia (Hz)&quot;,ylab=&quot;Potencia (uV^2)&quot;)</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>#Armazenar o espectro estimado médio de olhos fechados
ESPECTROof=ESPECTRO</code></pre>
<p>Para armazenar o espectro estimado médio de olhos abertos e colocar os dois no mesmo gráfico:</p>
<pre class="r"><code>ESPECTROoa=ESPECTRO

##### COLOCAR OS 2 espectros médios no mesmo grafico

#ZOOM no grafico
IX=10:200
plot((HZ/2)*IX/nrow(ESPECTROof), ESPECTROof[IX,29],
 type=&quot;l&quot;,xlab=&quot;Frequencia (Hz)&quot;,ylab=&quot;Potencia (uV^2)&quot;)

legend(&quot;topright&quot;,c(&quot;Olhos Fechados&quot;,&quot;Olhos Abertos&quot;),lty=c(1,1),
    col=c(1,2))</code></pre>
<p><img src="/aulas/5_Transformadas_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>No gráfico podemos o espectro para cada frequência (analisar o espectro para cada faixa) e não a evolução em si (pois não está no tempo).</p>
</div>
